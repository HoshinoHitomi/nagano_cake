<% if @cart_item.blank? %>
    <h1>カートが空です</h1>
    <% else %>

    <%= link_to "カートを空にする", destroy_all_cart_items_path, method: :delete %>

    <table>
        <tr>
            <th>商品名</th>
            <th>単価(税込)</th>
            <th>数量</th>
            <th>小計</th>
        </tr>
        <% @cart_item.each do |cart_item| %>
        <tr>
            <th>
                <%= attachment_image_tag cart_item[:image], :image, size: "800x800" %>
                <%= cart_item[:name] %>
            </th>

            <th><%= cart_item[:price].to_s(:delimited) %></th>

            <%= form_with url: cart_item_path(@cart_item), method: :patch, local:true do |f| %>
                <th>
                    <%= f.number_field :amount, value: cart_item[:amount], min: 1 %>
                    <%= hidden_field_tag :item_id, cart_item[:item_id] %>
                    <%= f.submit "変更" %>
                </th>
            <% end %>

            <th><%= cart_item[:sub_total].to_s(:delimited) %></th>

            <%= form_with url: cart_item_path(@cart_item), method: :delete, local:true do |f| %>
                <th>
                    <%= hidden_field_tag :item_id, cart_item[:item_id] %>
                    <%= f.submit "削除する" %>
                </th>
            <% end %>
        </tr>
        <% end %>
    </table>
    <%= @total_price.to_s(:delimited) %><br>

<% end %>

<%= link_to "買い物を続ける", items_path %>

<%= link_to "情報入力に進む", new_order_path %>